2025-12-02 17:49:41,304 - MainThread - sqlmesh.core.console - WARNING - The databricks engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2335)
2025-12-02 17:49:41,503 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-02 17:49:41,942 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:49:41,942 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:49:41,956 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0cfa7-482c-18fe-8333-60720372cbcf (session.py:143)
2025-12-02 17:49:42,023 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:49:42,023 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:49:51,995 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:49:51,995 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:49:57,497 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:49:57,497 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:00,119 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:00,119 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:00,244 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:00,244 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:00,522 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:00,522 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:00,674 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:00,674 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:05,700 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:05,700 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:06,050 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:06,050 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:06,537 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:06,537 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:08,110 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:08,110 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:12,757 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:12,757 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:14,369 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:14,369 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:15,703 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:15,703 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:16,713 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:16,713 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:17,104 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:17,104 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:17,309 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:17,309 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:26,604 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:26,604 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:27,494 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:27,494 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:27,494 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:123)
2025-12-02 17:50:28,456 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:28,456 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:33,332 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:33,332 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:33,348 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-12-02 17:50:33,348 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.sqlmesh__silver' (evaluator.py:1449)
2025-12-02 17:50:33,348 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`sqlmesh__silver` (base.py:2619)
2025-12-02 17:50:33,364 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-02 17:50:33,590 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:33,590 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:33,590 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0cfa7-6700-17a6-9491-9a7ef6929448 (session.py:143)
2025-12-02 17:50:33,988 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:33,988 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:33,988 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-12-02 17:50:34,004 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.sqlmesh__silver (evaluator.py:1616)
2025-12-02 17:50:34,004 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'sqlmesh__silver') AND `table_name` IN ('silver__transactions_2__615368167', 'silver__customers_2__562887494') (base.py:2619)
2025-12-02 17:50:34,798 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:34,798 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:34,821 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"newbankingdemo"."silver"."customers_2": 95111029> (evaluator.py:711)
2025-12-02 17:50:34,823 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-02 17:50:35,023 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:35,023 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:35,028 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"newbankingdemo"."silver"."customers_2": 95111029> (evaluator.py:952)
2025-12-02 17:50:35,040 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-12-01 00:00:00, 2025-12-02 00:00:00) into newbankingdemo.sqlmesh__silver.silver__customers_2__562887494' (evaluator.py:984)
2025-12-02 17:50:35,052 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ CREATE TABLE IF NOT EXISTS `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` AS SELECT CAST(`customernumber` AS STRING) AS `customernumber`, CAST(`firstname` AS STRING) AS `firstname`, CAST(`surname` AS STRING) AS `surname`, CAST(`dateofbirth` AS DATE) AS `dateofbirth`, CAST(`gender` AS STRING) AS `gender`, CAST(`emailaddress` AS STRING) AS `emailaddress`, CAST(`ukpostcode` AS STRING) AS `ukpostcode`, CAST(`housenumber` AS STRING) AS `housenumber`, CAST(`streetaddress` AS STRING) AS `streetaddress`, CAST(`town` AS STRING) AS `town` FROM (SELECT CAST(`customernumber` AS STRING) AS `customernumber`, CAST(`firstname` AS STRING) AS `firstname`, CAST(`surname` AS STRING) AS `surname`, CAST(`dateofbirth` AS DATE) AS `dateofbirth`, CAST(`gender` AS STRING) AS `gender`, CAST(`emailaddress` AS STRING) AS `emailaddress`, CAST(`ukpostcode` AS STRING) AS `ukpostcode`, CAST(`housenumber` AS STRING) AS `housenumber`, CAST(`streetaddress` AS STRING) AS `streetaddress`, CAST(`town` AS STRING) AS `town` FROM `newbankingdemo`.`bronze`.`customers_2` AS `customers_2`) AS `_subquery` (base.py:2619)
2025-12-02 17:50:40,015 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:40,015 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:40,028 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:40,264 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:40,264 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:40,286 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `customernumber` COMMENT 'The Customer Number of the Account holder' (base.py:2619)
2025-12-02 17:50:41,482 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:41,482 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:41,489 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:41,673 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:41,673 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:41,682 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `firstname` COMMENT 'The First Name of the account holder' (base.py:2619)
2025-12-02 17:50:42,563 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:42,563 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:42,570 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:42,785 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:42,785 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:42,790 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `surname` COMMENT 'The Surname of the Account holder' (base.py:2619)
2025-12-02 17:50:43,576 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:43,576 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:43,594 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:43,788 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:43,790 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:43,797 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `dateofbirth` COMMENT 'The Date of Birth of Account Holder' (base.py:2619)
2025-12-02 17:50:44,708 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:44,708 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:44,708 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:44,935 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:44,936 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:44,956 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `gender` COMMENT 'The Gender of the Account Holder' (base.py:2619)
2025-12-02 17:50:45,855 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:45,855 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:45,859 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:46,060 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:46,060 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:46,070 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `emailaddress` COMMENT 'The Email Address of the Account Holder' (base.py:2619)
2025-12-02 17:50:46,978 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:46,978 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:46,978 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:47,159 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:47,160 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:47,169 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `ukpostcode` COMMENT 'The Postcode of the Account Holder' (base.py:2619)
2025-12-02 17:50:47,990 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:47,990 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:48,003 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:48,205 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:48,205 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:48,225 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `housenumber` COMMENT 'The HouseNumber of the Account Holder' (base.py:2619)
2025-12-02 17:50:49,378 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:49,378 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:49,382 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:49,572 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:49,572 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:49,586 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `streetaddress` COMMENT 'The Address of the Account Holder' (base.py:2619)
2025-12-02 17:50:50,373 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:50,374 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:50,380 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:50,586 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:50,586 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:50,586 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` ALTER COLUMN `town` COMMENT 'The Town of the Account Holder' (base.py:2619)
2025-12-02 17:50:51,640 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:51,640 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:51,640 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-01 00:00:00, 2025-12-02 00:00:00) for snapshot SnapshotId<"newbankingdemo"."silver"."customers_2": 95111029> (facade.py:637)
2025-12-02 17:50:51,640 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."silver"."customers_2": 95111029> (interval.py:215)
2025-12-02 17:50:53,831 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:53,847 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:53,882 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"newbankingdemo"."silver"."transactions_2": 1157795900> (evaluator.py:711)
2025-12-02 17:50:53,884 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-02 17:50:54,065 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:54,065 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:54,065 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"newbankingdemo"."silver"."transactions_2": 1157795900> (evaluator.py:952)
2025-12-02 17:50:54,081 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-12-01 00:00:00, 2025-12-02 00:00:00) into newbankingdemo.sqlmesh__silver.silver__transactions_2__615368167' (evaluator.py:984)
2025-12-02 17:50:54,081 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ CREATE TABLE IF NOT EXISTS `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__615368167` AS SELECT CAST(`accountnumber` AS STRING) AS `accountnumber`, CAST(`customernumber` AS STRING) AS `customernumber`, CAST(`transactiondate` AS TIMESTAMP_NTZ) AS `transactiondate`, CAST(`transactionamount` AS DECIMAL(15, 2)) AS `transactionamount` FROM (SELECT CAST(`accountnumber` AS STRING) AS `accountnumber`, CAST(`customernumber` AS STRING) AS `customernumber`, CAST(`transactiondate` AS TIMESTAMP_NTZ) AS `transactiondate`, CAST(`transactionamount` AS DECIMAL(15, 2)) AS `transactionamount` FROM `newbankingdemo`.`bronze`.`transactions_2` AS `transactions_2`) AS `_subquery` (base.py:2619)
2025-12-02 17:50:57,725 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:57,725 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:57,733 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:57,900 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:57,900 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:57,914 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__615368167` ALTER COLUMN `accountnumber` COMMENT 'The Account Number of the account' (base.py:2619)
2025-12-02 17:50:58,870 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:58,871 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:58,878 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:59,027 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:59,027 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:59,027 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__615368167` ALTER COLUMN `customernumber` COMMENT 'The Customer Number of the account owner' (base.py:2619)
2025-12-02 17:50:59,809 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:59,809 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:59,816 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:50:59,989 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:50:59,989 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:50:59,991 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__615368167` ALTER COLUMN `transactiondate` COMMENT 'The date of the account transaction' (base.py:2619)
2025-12-02 17:51:00,900 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:00,900 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:00,911 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-02 17:51:01,155 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:01,155 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:01,162 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ ALTER TABLE `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__615368167` ALTER COLUMN `transactionamount` COMMENT 'The amount of the transaction' (base.py:2619)
2025-12-02 17:51:02,246 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:02,246 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:02,253 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-01 00:00:00, 2025-12-02 00:00:00) for snapshot SnapshotId<"newbankingdemo"."silver"."transactions_2": 1157795900> (facade.py:637)
2025-12-02 17:51:02,254 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."silver"."transactions_2": 1157795900> (interval.py:215)
2025-12-02 17:51:03,843 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:03,843 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:03,859 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-12-02 17:51:03,859 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'dd' (facade.py:167)
2025-12-02 17:51:04,773 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:04,773 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:04,975 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:04,975 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:07,022 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:07,022 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:08,178 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:08,178 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:10,671 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:10,671 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:11,634 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:11,634 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:11,634 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-12-02 17:51:11,642 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.silver__dd' (evaluator.py:1449)
2025-12-02 17:51:11,642 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`silver__dd` (base.py:2619)
2025-12-02 17:51:11,854 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:11,854 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:11,867 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.silver__dd (evaluator.py:1616)
2025-12-02 17:51:11,867 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'silver__dd') AND `table_name` IN ('transactions_2', 'customers_2', 'accounts_2') (base.py:2619)
2025-12-02 17:51:12,193 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:12,193 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:12,201 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-02 17:51:12,392 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:12,392 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:12,398 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.silver__dd.accounts_2' to point at table 'newbankingdemo.sqlmesh__silver.silver__accounts_2__3741260822' (evaluator.py:1988)
2025-12-02 17:51:12,402 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ CREATE OR REPLACE VIEW `newbankingdemo`.`silver__dd`.`accounts_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__silver`.`silver__accounts_2__3741260822` (base.py:2619)
2025-12-02 17:51:13,149 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:13,149 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:13,172 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-02 17:51:13,458 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:13,458 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:13,470 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.silver__dd.customers_2' to point at table 'newbankingdemo.sqlmesh__silver.silver__customers_2__562887494' (evaluator.py:1988)
2025-12-02 17:51:13,473 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ CREATE OR REPLACE VIEW `newbankingdemo`.`silver__dd`.`customers_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` (base.py:2619)
2025-12-02 17:51:13,950 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:13,950 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:13,965 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-02 17:51:14,173 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:14,173 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:14,179 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.silver__dd.transactions_2' to point at table 'newbankingdemo.sqlmesh__silver.silver__transactions_2__615368167' (evaluator.py:1988)
2025-12-02 17:51:14,183 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: c296b70c10ea4d63956d3e838d503aba */ CREATE OR REPLACE VIEW `newbankingdemo`.`silver__dd`.`transactions_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__615368167` (base.py:2619)
2025-12-02 17:51:14,681 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:14,683 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:14,701 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-12-02 17:51:14,702 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'dd' (environment.py:141)
2025-12-02 17:51:15,245 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:15,245 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:17,600 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:17,600 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:17,618 - MainThread - databricks.sql.session - INFO - Closing session 01f0cfa7-6700-17a6-9491-9a7ef6929448 (session.py:194)
2025-12-02 17:51:17,678 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:17,678 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:17,678 - MainThread - databricks.sql.session - INFO - Closing session 01f0cfa7-482c-18fe-8333-60720372cbcf (session.py:194)
2025-12-02 17:51:17,762 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 17:51:17,762 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 17:51:17,762 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
