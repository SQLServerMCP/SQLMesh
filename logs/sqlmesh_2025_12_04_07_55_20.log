2025-12-04 07:55:21,430 - MainThread - sqlmesh.core.console - WARNING - The databricks engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2335)
2025-12-04 07:55:21,629 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-04 07:55:21,816 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:21,816 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:21,816 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0d0e6-9670-1d95-912d-630990443712 (session.py:143)
2025-12-04 07:55:22,114 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:22,114 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:22,258 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:22,258 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:22,481 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:22,481 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:22,628 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:22,628 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:22,962 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:22,962 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:23,118 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:23,118 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:24,247 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:24,247 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:24,905 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:24,905 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:25,471 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:25,471 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:25,487 - MainThread - sqlmesh.core.state_sync.common - INFO - Cleaned up 0 expired snapshots (janitor.py:181)
2025-12-04 07:55:26,360 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:26,360 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 21 intervals for 12 snapshots (interval.py:130)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."gold"."accounts_2": 3101799127> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."gold"."customers_2": 1076732822> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 4204978203> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 3235455814> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 927298813> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 3992093364> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 75706869> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."silver"."accounts_2": 341872557> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."silver"."customers_2": 95111029> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."silver"."transactions_2": 915784264> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."silver"."transactions_2": 3397586131> (interval.py:215)
2025-12-04 07:55:26,381 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."silver"."transactions_2": 1157795900> (interval.py:215)
2025-12-04 07:55:28,713 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:28,713 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:30,009 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:30,009 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:30,357 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:30,357 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:30,531 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:30,531 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:31,071 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:31,071 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:31,868 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:31,868 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:32,030 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:32,030 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:32,226 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:32,226 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:32,902 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:32,902 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:33,179 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:33,179 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:33,189 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.sqlmesh__gold (evaluator.py:1616)
2025-12-04 07:55:33,226 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-04 07:55:33,408 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:33,408 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:33,410 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0d0e6-9d57-1dc2-975e-7e5cb47c2930 (session.py:143)
2025-12-04 07:55:33,413 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'sqlmesh__gold') AND `table_name` IN ('gold__transactions_2__553716356') (base.py:2619)
2025-12-04 07:55:33,769 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:33,769 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:33,956 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:33,956 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:33,982 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 75706869> (evaluator.py:711)
2025-12-04 07:55:33,984 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:55:34,149 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:34,149 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:34,156 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 75706869> (evaluator.py:952)
2025-12-04 07:55:34,173 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-12-02 00:00:00, 2025-12-04 00:00:00) into newbankingdemo.sqlmesh__gold.gold__transactions_2__553716356' (evaluator.py:984)
2025-12-04 07:55:34,173 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` REPLACE WHERE TRUE SELECT CAST(`transactions_2`.`accountnumber` AS STRING) AS `accountnumber`, CAST(`transactions_2`.`customernumber` AS STRING) AS `customernumber`, CAST(YEAR(`transactions_2`.`transactiondate`) AS INT) AS `transactionyear`, CAST(MONTH(`transactions_2`.`transactiondate`) AS INT) AS `transactionmonth`, CAST(MONTHNAME(`transactions_2`.`transactiondate`) AS STRING) AS `transactionmonthname`, CAST(DAY(`transactions_2`.`transactiondate`) AS INT) AS `transactionday`, CAST(DAYNAME(`transactions_2`.`transactiondate`) AS STRING) AS `transactiondayname`, CAST(`transactions_2`.`transactionamount` AS DECIMAL(15, 2)) AS `transactionamount` FROM `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__3316432348` AS `transactions_2` (base.py:2619)
2025-12-04 07:55:36,693 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:36,693 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:36,711 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-02 00:00:00, 2025-12-04 00:00:00) for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 75706869> (facade.py:637)
2025-12-04 07:55:36,711 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 75706869> (interval.py:215)
2025-12-04 07:55:38,106 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:38,106 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:38,138 - MainThread - databricks.sql.session - INFO - Closing session 01f0d0e6-9d57-1dc2-975e-7e5cb47c2930 (session.py:194)
2025-12-04 07:55:38,211 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:38,211 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:38,212 - MainThread - databricks.sql.session - INFO - Closing session 01f0d0e6-9670-1d95-912d-630990443712 (session.py:194)
2025-12-04 07:55:38,282 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:38,282 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:38,289 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
