2025-11-25 15:52:24,455 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:492)
2025-11-25 15:52:24,536 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:482)
2025-11-25 15:52:24,619 - MainThread - sqlmesh.core.state_sync.common - INFO - Processing batch of size 7 with end updated_ts=1762961643925 (janitor.py:163)
2025-11-25 15:52:24,620 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model_balance__3240318669__dev" CASCADE (base.py:2619)
2025-11-25 15:52:24,621 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model_balance__3240318669__dev' (evaluator.py:2125)
2025-11-25 15:52:24,623 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model_balance__3240318669" CASCADE (base.py:2619)
2025-11-25 15:52:24,624 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model_balance__3240318669' (evaluator.py:2125)
2025-11-25 15:52:24,626 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_balances_model__3773790553__dev" CASCADE (base.py:2619)
2025-11-25 15:52:24,627 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_balances_model__3773790553__dev' (evaluator.py:2125)
2025-11-25 15:52:24,628 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_balances_model__3773790553" CASCADE (base.py:2619)
2025-11-25 15:52:24,628 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_balances_model__3773790553' (evaluator.py:2125)
2025-11-25 15:52:24,630 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__2396538925__dev" CASCADE (base.py:2619)
2025-11-25 15:52:24,631 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model_balance__2396538925__dev' (evaluator.py:2125)
2025-11-25 15:52:24,632 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__2396538925" CASCADE (base.py:2619)
2025-11-25 15:52:24,634 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model_balance__2396538925' (evaluator.py:2125)
2025-11-25 15:52:24,635 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_balances_model__1054067038__dev" CASCADE (base.py:2619)
2025-11-25 15:52:24,638 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_balances_model__1054067038__dev' (evaluator.py:2125)
2025-11-25 15:52:24,639 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_balances_model__1054067038" CASCADE (base.py:2619)
2025-11-25 15:52:24,640 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropped table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_balances_model__1054067038' (evaluator.py:2125)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 11 intervals for 11 snapshots (interval.py:130)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 1267569955> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 4098094839> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 1637728402> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 2041857329> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 94390175> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 2896339908> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 196852220> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 3776258859> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."seed_balances_model": 1411555765> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."seed_balances_model": 3914925182> (interval.py:215)
2025-11-25 15:52:24,669 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 640346792> (interval.py:215)
2025-11-25 15:52:24,683 - MainThread - sqlmesh.core.state_sync.common - INFO - Cleaned up expired snapshots batch (janitor.py:179)
2025-11-25 15:52:24,701 - MainThread - sqlmesh.core.state_sync.common - INFO - Cleaned up 7 expired snapshots (janitor.py:181)
2025-11-25 15:52:24,710 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Compacting 1 intervals for 1 snapshots (interval.py:130)
2025-11-25 15:52:24,710 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot None (interval.py:215)
2025-11-25 15:52:24,774 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:1616)
2025-11-25 15:52:24,774 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:52:24,774 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:52:24,774 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__incremental_model_balance__1165446840', 'sqlmesh_example__full_model_balance__2356143081', 'sqlmesh_example__incremental_model__3572673861', 'sqlmesh_example__full_model__635791289') (base.py:2619)
2025-11-25 15:52:24,800 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 94390175> (evaluator.py:711)
2025-11-25 15:52:24,801 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 94390175> (evaluator.py:952)
2025-11-25 15:52:24,801 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-11-12 00:00:00, 2025-11-25 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3572673861' (evaluator.py:984)
2025-11-25 15:52:24,801 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" WHERE "event_date" BETWEEN CAST('2025-11-12' AS DATE) AND CAST('2025-11-24' AS DATE) (base.py:2619)
2025-11-25 15:52:24,801 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" ("id", "item_id", "event_date") SELECT "id", "item_id", "event_date" FROM (SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" AS "seed_model" WHERE "seed_model"."event_date" <= CAST('2025-11-24' AS DATE) AND "seed_model"."event_date" >= CAST('2025-11-12' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2025-11-12' AS DATE) AND CAST('2025-11-24' AS DATE) (base.py:2619)
2025-11-25 15:52:24,815 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-11-12 00:00:00, 2025-11-25 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 94390175> (facade.py:637)
2025-11-25 15:52:24,815 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 94390175> (interval.py:215)
2025-11-25 15:52:24,830 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 2896339908> (evaluator.py:711)
2025-11-25 15:52:24,831 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 2896339908> (evaluator.py:952)
2025-11-25 15:52:24,838 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-11-12 00:00:00, 2025-11-25 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model_balance__1165446840' (evaluator.py:984)
2025-11-25 15:52:24,840 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__1165446840" WHERE "event_date" BETWEEN CAST('2025-11-12' AS DATE) AND CAST('2025-11-24' AS DATE) (base.py:2619)
2025-11-25 15:52:24,843 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__1165446840" ("custname", "account", "balance", "event_date") SELECT "custname", "account", "balance", "event_date" FROM (SELECT "seed_balances_model"."custname" AS "custname", "seed_balances_model"."account" AS "account", "seed_balances_model"."balance" AS "balance", "seed_balances_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_balances_model__1581770611" AS "seed_balances_model" WHERE "seed_balances_model"."event_date" <= CAST('2025-11-24' AS DATE) AND "seed_balances_model"."event_date" >= CAST('2025-11-12' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2025-11-12' AS DATE) AND CAST('2025-11-24' AS DATE) (base.py:2619)
2025-11-25 15:52:24,844 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-11-12 00:00:00, 2025-11-25 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 2896339908> (facade.py:637)
2025-11-25 15:52:24,844 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 2896339908> (interval.py:215)
2025-11-25 15:52:24,861 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2538990275> (evaluator.py:711)
2025-11-25 15:52:24,862 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2538990275> (evaluator.py:952)
2025-11-25 15:52:24,866 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-11-12 00:00:00, 2025-11-25 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__635791289' (evaluator.py:984)
2025-11-25 15:52:24,866 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:52:24,866 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-11-25 15:52:24,874 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" AS SELECT CAST("item_id" AS INT) AS "item_id", CAST("num_orders" AS BIGINT) AS "num_orders" FROM (SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" AS "incremental_model" GROUP BY "incremental_model"."item_id") AS "_subquery" (base.py:2619)
2025-11-25 15:52:24,874 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2538990275> (evaluator.py:603)
2025-11-25 15:52:24,878 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" (base.py:2619)
2025-11-25 15:52:24,883 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" AS "sqlmesh_example__full_model__635791289" WHERE "item_id" < 0) AS "audit" (base.py:2619)
2025-11-25 15:52:24,886 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-11-12 00:00:00, 2025-11-25 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2538990275> (facade.py:637)
2025-11-25 15:52:24,886 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2538990275> (interval.py:215)
2025-11-25 15:52:24,903 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 4098094839> (evaluator.py:711)
2025-11-25 15:52:24,903 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 4098094839> (evaluator.py:952)
2025-11-25 15:52:24,907 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-11-12 00:00:00, 2025-11-25 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model_balance__2356143081' (evaluator.py:984)
2025-11-25 15:52:24,907 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:52:24,907 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-11-25 15:52:24,907 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model_balance__2356143081" AS SELECT CAST("account" AS TEXT) AS "account", CAST("totalbalance" AS DECIMAL(18, 3)) AS "totalbalance" FROM (SELECT "incremental_model_balance"."account" AS "account", SUM("incremental_model_balance"."balance") AS "totalbalance" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__1165446840" AS "incremental_model_balance" GROUP BY "incremental_model_balance"."account") AS "_subquery" (base.py:2619)
2025-11-25 15:52:24,916 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-11-12 00:00:00, 2025-11-25 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 4098094839> (facade.py:637)
2025-11-25 15:52:24,916 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 4098094839> (interval.py:215)
2025-11-25 15:52:24,953 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
