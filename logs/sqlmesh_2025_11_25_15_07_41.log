2025-11-25 15:07:41,608 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:492)
2025-11-25 15:07:42,688 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:494)
2025-11-25 15:07:42,829 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:482)
2025-11-25 15:07:47,789 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:123)
2025-11-25 15:07:47,818 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-11-25 15:07:47,819 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1449)
2025-11-25 15:07:47,820 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2619)
2025-11-25 15:07:47,820 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-11-25 15:07:47,823 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:1616)
2025-11-25 15:07:47,823 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:07:47,824 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:07:47,826 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__incremental_model_balance__711442316', 'sqlmesh_example__full_model_balance__3056169384') (base.py:2619)
2025-11-25 15:07:47,845 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating a physical table for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 3776258859> (evaluator.py:870)
2025-11-25 15:07:47,858 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model_balance__711442316' (evaluator.py:2042)
2025-11-25 15:07:47,858 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:07:47,858 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-11-25 15:07:47,862 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__711442316" ("custname" TEXT, "account" TEXT, "balance" DECIMAL(18, 3), "event_date" DATE, "var" INT) (base.py:2619)
2025-11-25 15:07:47,864 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.incremental_model_balance' (evaluator.py:2064)
2025-11-25 15:07:47,864 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT CAST("seed_balances_model"."custname" AS TEXT) AS "custname", "seed_balances_model"."account" AS "account", "seed_balances_model"."balance" AS "balance", "seed_balances_model"."event_date" AS "event_date", CAST(85 AS INT) AS "var" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_balances_model__1581770611" AS "seed_balances_model" WHERE ("seed_balances_model"."event_date" <= CAST('1970-01-01' AS DATE) AND "seed_balances_model"."event_date" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:2619)
2025-11-25 15:07:47,864 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 3776258859> (evaluator.py:711)
2025-11-25 15:07:47,864 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 3776258859> (evaluator.py:952)
2025-11-25 15:07:47,876 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00, 2025-11-12 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model_balance__711442316' (evaluator.py:984)
2025-11-25 15:07:47,877 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__711442316" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2025-11-11' AS DATE) (base.py:2619)
2025-11-25 15:07:47,880 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__711442316" ("custname", "account", "balance", "event_date", "var") SELECT "custname", "account", "balance", "event_date", "var" FROM (SELECT CAST("seed_balances_model"."custname" AS TEXT) AS "custname", "seed_balances_model"."account" AS "account", "seed_balances_model"."balance" AS "balance", "seed_balances_model"."event_date" AS "event_date", CAST(85 AS INT) AS "var" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_balances_model__1581770611" AS "seed_balances_model" WHERE "seed_balances_model"."event_date" <= CAST('2025-11-11' AS DATE) AND "seed_balances_model"."event_date" >= CAST('2020-01-01' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2025-11-11' AS DATE) (base.py:2619)
2025-11-25 15:07:47,883 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2020-01-01 00:00:00, 2025-11-12 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 3776258859> (facade.py:637)
2025-11-25 15:07:47,883 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model_balance": 3776258859> (interval.py:215)
2025-11-25 15:07:47,899 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 1637728402> (evaluator.py:711)
2025-11-25 15:07:47,900 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 1637728402> (evaluator.py:952)
2025-11-25 15:07:47,904 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-11-11 00:00:00, 2025-11-12 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model_balance__3056169384' (evaluator.py:984)
2025-11-25 15:07:47,905 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:07:47,907 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-11-25 15:07:47,908 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model_balance__3056169384" AS SELECT CAST("account" AS TEXT) AS "account", CAST("totalbalance" AS DECIMAL(18, 3)) AS "totalbalance" FROM (SELECT "incremental_model_balance"."account" AS "account", SUM("incremental_model_balance"."balance") AS "totalbalance" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__711442316" AS "incremental_model_balance" GROUP BY "incremental_model_balance"."account") AS "_subquery" (base.py:2619)
2025-11-25 15:07:47,913 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-11-11 00:00:00, 2025-11-12 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 1637728402> (facade.py:637)
2025-11-25 15:07:47,913 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model_balance": 1637728402> (interval.py:215)
2025-11-25 15:07:47,935 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-11-25 15:07:47,935 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'dev' (facade.py:167)
2025-11-25 15:07:47,961 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-11-25 15:07:47,965 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example__dev' (evaluator.py:1449)
2025-11-25 15:07:47,965 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example__dev" (base.py:2619)
2025-11-25 15:07:47,967 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh_example__dev (evaluator.py:1616)
2025-11-25 15:07:47,967 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:07:47,968 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-25 15:07:47,969 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh_example__dev') AND table_name IN ('incremental_model_balance', 'seed_balances_model', 'full_model_balance') (base.py:2619)
2025-11-25 15:07:47,977 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.seed_balances_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_balances_model__1581770611' (evaluator.py:1988)
2025-11-25 15:07:47,978 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."seed_balances_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_balances_model__1581770611" (base.py:2619)
2025-11-25 15:07:47,981 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.incremental_model_balance' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model_balance__711442316' (evaluator.py:1988)
2025-11-25 15:07:47,983 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."incremental_model_balance" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__711442316" (base.py:2619)
2025-11-25 15:07:47,985 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.full_model_balance' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model_balance__3056169384' (evaluator.py:1988)
2025-11-25 15:07:47,985 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."full_model_balance" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model_balance__3056169384" (base.py:2619)
2025-11-25 15:07:47,992 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropping view 'db.sqlmesh_example__dev.seed_model' (evaluator.py:2019)
2025-11-25 15:07:47,992 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ DROP VIEW IF EXISTS "db"."sqlmesh_example__dev"."seed_model" (base.py:2619)
2025-11-25 15:07:47,997 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropping view 'db.sqlmesh_example__dev.incremental_model' (evaluator.py:2019)
2025-11-25 15:07:47,997 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ DROP VIEW IF EXISTS "db"."sqlmesh_example__dev"."incremental_model" (base.py:2619)
2025-11-25 15:07:48,000 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dropping view 'db.sqlmesh_example__dev.full_model' (evaluator.py:2019)
2025-11-25 15:07:48,000 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: fb33940a79614baeb798b2fb1bf0cd8f */ DROP VIEW IF EXISTS "db"."sqlmesh_example__dev"."full_model" (base.py:2619)
2025-11-25 15:07:48,009 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-11-25 15:07:48,009 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'dev' (environment.py:141)
2025-11-25 15:07:48,058 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
