2025-12-04 07:53:36,887 - MainThread - sqlmesh.core.console - WARNING - The databricks engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2335)
2025-12-04 07:53:37,083 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-04 07:53:37,376 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:37,379 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:37,379 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0d0e6-582d-171a-bc2e-a3a56e3b36ba (session.py:143)
2025-12-04 07:53:38,174 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:38,174 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:38,392 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:38,392 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:38,657 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:38,657 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:38,830 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:38,830 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:39,429 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:39,429 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:40,223 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:40,223 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:41,174 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:41,174 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:41,454 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:41,454 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:42,086 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:42,086 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:42,951 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:42,951 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:43,625 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:43,625 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:43,837 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:43,837 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:44,658 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:44,658 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:44,932 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:44,932 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:51,353 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:51,353 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:52,149 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:52,149 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:52,196 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:123)
2025-12-04 07:53:52,538 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:52,538 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:54,439 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:54,439 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:54,456 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-12-04 07:53:54,456 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.sqlmesh__silver' (evaluator.py:1449)
2025-12-04 07:53:54,456 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`sqlmesh__silver` (base.py:2619)
2025-12-04 07:53:54,471 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-04 07:53:54,684 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:54,684 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:54,684 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0d0e6-627e-1d43-ab5d-ee432431db9b (session.py:143)
2025-12-04 07:53:55,048 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:55,048 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:55,048 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.sqlmesh__gold' (evaluator.py:1449)
2025-12-04 07:53:55,048 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`sqlmesh__gold` (base.py:2619)
2025-12-04 07:53:55,249 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:55,253 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:55,254 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-12-04 07:53:55,254 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.sqlmesh__gold (evaluator.py:1616)
2025-12-04 07:53:55,254 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'sqlmesh__gold') AND `table_name` IN ('gold__transactions_2__553716356') (base.py:2619)
2025-12-04 07:53:55,504 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:55,505 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:55,514 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 75706869> (evaluator.py:711)
2025-12-04 07:53:55,514 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:53:55,687 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:55,687 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:55,690 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 75706869> (evaluator.py:952)
2025-12-04 07:53:55,702 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-12-01 00:00:00, 2025-12-02 00:00:00) into newbankingdemo.sqlmesh__gold.gold__transactions_2__553716356' (evaluator.py:984)
2025-12-04 07:53:55,707 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE TABLE IF NOT EXISTS `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` AS SELECT CAST(`accountnumber` AS STRING) AS `accountnumber`, CAST(`customernumber` AS STRING) AS `customernumber`, CAST(`transactionyear` AS INT) AS `transactionyear`, CAST(`transactionmonth` AS INT) AS `transactionmonth`, CAST(`transactionmonthname` AS STRING) AS `transactionmonthname`, CAST(`transactionday` AS INT) AS `transactionday`, CAST(`transactiondayname` AS STRING) AS `transactiondayname`, CAST(`transactionamount` AS DECIMAL(15, 2)) AS `transactionamount` FROM (SELECT CAST(`transactions_2`.`accountnumber` AS STRING) AS `accountnumber`, CAST(`transactions_2`.`customernumber` AS STRING) AS `customernumber`, CAST(YEAR(`transactions_2`.`transactiondate`) AS INT) AS `transactionyear`, CAST(MONTH(`transactions_2`.`transactiondate`) AS INT) AS `transactionmonth`, CAST(MONTHNAME(`transactions_2`.`transactiondate`) AS STRING) AS `transactionmonthname`, CAST(DAY(`transactions_2`.`transactiondate`) AS INT) AS `transactionday`, CAST(DAYNAME(`transactions_2`.`transactiondate`) AS STRING) AS `transactiondayname`, CAST(`transactions_2`.`transactionamount` AS DECIMAL(15, 2)) AS `transactionamount` FROM `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__3316432348` AS `transactions_2`) AS `_subquery` (base.py:2619)
2025-12-04 07:53:59,233 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:59,233 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:59,256 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-04 07:53:59,450 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:53:59,450 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:53:59,469 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ ALTER TABLE `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` ALTER COLUMN `accountnumber` COMMENT 'The Account Number of the account' (base.py:2619)
2025-12-04 07:54:00,557 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:00,557 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:00,561 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-04 07:54:00,747 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:00,747 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:00,760 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ ALTER TABLE `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` ALTER COLUMN `customernumber` COMMENT 'The Customer Number of the account owner' (base.py:2619)
2025-12-04 07:54:01,608 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:01,608 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:01,616 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-04 07:54:01,802 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:01,802 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:01,822 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ ALTER TABLE `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` ALTER COLUMN `transactionyear` COMMENT 'The Year the transaction occurred' (base.py:2619)
2025-12-04 07:54:02,584 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:02,584 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:02,588 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-04 07:54:02,843 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:02,847 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:02,851 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ ALTER TABLE `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` ALTER COLUMN `transactionmonth` COMMENT 'The Month the transaction occurred' (base.py:2619)
2025-12-04 07:54:03,613 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:03,613 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:03,634 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-04 07:54:03,802 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:03,802 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:03,815 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ ALTER TABLE `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` ALTER COLUMN `transactionmonthname` COMMENT 'The MonthName the transaction occurred' (base.py:2619)
2025-12-04 07:54:04,622 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:04,624 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:04,630 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-04 07:54:04,829 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:04,829 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:04,836 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ ALTER TABLE `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` ALTER COLUMN `transactionday` COMMENT 'The Day the transaction occurred' (base.py:2619)
2025-12-04 07:54:05,665 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:05,665 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:05,682 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-04 07:54:05,855 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:05,855 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:05,863 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ ALTER TABLE `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` ALTER COLUMN `transactiondayname` COMMENT 'The Day Name the transaction occurred' (base.py:2619)
2025-12-04 07:54:06,624 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:06,624 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:06,632 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-04 07:54:06,854 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:06,855 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:06,865 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ ALTER TABLE `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` ALTER COLUMN `transactionamount` COMMENT 'The amount of the transaction' (base.py:2619)
2025-12-04 07:54:07,748 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:07,749 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:07,753 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-01 00:00:00, 2025-12-02 00:00:00) for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 75706869> (facade.py:637)
2025-12-04 07:54:07,753 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"newbankingdemo"."gold"."transactions_2": 75706869> (interval.py:215)
2025-12-04 07:54:09,288 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:09,288 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:09,310 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-12-04 07:54:09,310 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'dd' (facade.py:167)
2025-12-04 07:54:09,969 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:09,969 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:10,266 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:10,266 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:12,674 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:12,674 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:13,745 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:13,745 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:15,415 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:15,415 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:16,237 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:16,237 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:16,237 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-12-04 07:54:16,256 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.gold__dd' (evaluator.py:1449)
2025-12-04 07:54:16,257 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`gold__dd` (base.py:2619)
2025-12-04 07:54:16,436 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:16,436 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:16,452 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.silver__dd' (evaluator.py:1449)
2025-12-04 07:54:16,452 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`silver__dd` (base.py:2619)
2025-12-04 07:54:16,681 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:16,681 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:16,688 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.silver__dd (evaluator.py:1616)
2025-12-04 07:54:16,688 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'silver__dd') AND `table_name` IN ('customers_2', 'accounts_2', 'transactions_2') (base.py:2619)
2025-12-04 07:54:17,018 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:17,018 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:17,032 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.gold__dd (evaluator.py:1616)
2025-12-04 07:54:17,036 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'gold__dd') AND `table_name` IN ('customers_2', 'accounts_2', 'transactions_2') (base.py:2619)
2025-12-04 07:54:17,353 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:17,353 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:17,367 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:54:17,555 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:17,555 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:17,557 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.silver__dd.accounts_2' to point at table 'newbankingdemo.sqlmesh__silver.silver__accounts_2__3741260822' (evaluator.py:1988)
2025-12-04 07:54:17,557 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE OR REPLACE VIEW `newbankingdemo`.`silver__dd`.`accounts_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__silver`.`silver__accounts_2__3741260822` (base.py:2619)
2025-12-04 07:54:18,253 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:18,253 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:18,272 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:54:18,421 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:18,421 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:18,424 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.silver__dd.customers_2' to point at table 'newbankingdemo.sqlmesh__silver.silver__customers_2__562887494' (evaluator.py:1988)
2025-12-04 07:54:18,426 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE OR REPLACE VIEW `newbankingdemo`.`silver__dd`.`customers_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__silver`.`silver__customers_2__562887494` (base.py:2619)
2025-12-04 07:54:18,953 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:18,953 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:18,953 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:54:19,118 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:19,118 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:19,134 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.silver__dd.transactions_2' to point at table 'newbankingdemo.sqlmesh__silver.silver__transactions_2__3316432348' (evaluator.py:1988)
2025-12-04 07:54:19,134 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE OR REPLACE VIEW `newbankingdemo`.`silver__dd`.`transactions_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__3316432348` (base.py:2619)
2025-12-04 07:54:19,690 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:19,690 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:19,697 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:54:19,905 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:19,905 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:19,907 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.gold__dd.accounts_2' to point at table 'newbankingdemo.sqlmesh__gold.gold__accounts_2__2894313673' (evaluator.py:1988)
2025-12-04 07:54:19,908 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE OR REPLACE VIEW `newbankingdemo`.`gold__dd`.`accounts_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__gold`.`gold__accounts_2__2894313673` (base.py:2619)
2025-12-04 07:54:20,485 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:20,485 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:20,487 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:54:20,653 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:20,653 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:20,668 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.gold__dd.customers_2' to point at table 'newbankingdemo.sqlmesh__gold.gold__customers_2__2439568028' (evaluator.py:1988)
2025-12-04 07:54:20,673 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE OR REPLACE VIEW `newbankingdemo`.`gold__dd`.`customers_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__gold`.`gold__customers_2__2439568028` (base.py:2619)
2025-12-04 07:54:21,231 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:21,231 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:21,250 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:54:21,403 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:21,403 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:21,405 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.gold__dd.transactions_2' to point at table 'newbankingdemo.sqlmesh__gold.gold__transactions_2__553716356' (evaluator.py:1988)
2025-12-04 07:54:21,407 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 2ed9b526af6d45a0800ccbb64a6b287a */ CREATE OR REPLACE VIEW `newbankingdemo`.`gold__dd`.`transactions_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` (base.py:2619)
2025-12-04 07:54:22,004 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:22,004 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:22,026 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-12-04 07:54:22,026 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'dd' (environment.py:141)
2025-12-04 07:54:22,476 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:22,476 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:24,345 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:24,345 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:24,361 - MainThread - databricks.sql.session - INFO - Closing session 01f0d0e6-627e-1d43-ab5d-ee432431db9b (session.py:194)
2025-12-04 07:54:24,436 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:24,436 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:24,436 - MainThread - databricks.sql.session - INFO - Closing session 01f0d0e6-582d-171a-bc2e-a3a56e3b36ba (session.py:194)
2025-12-04 07:54:24,488 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:24,488 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:24,505 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
