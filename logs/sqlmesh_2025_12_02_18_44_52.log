2025-12-02 18:44:57,938 - MainThread - sqlmesh.core.console - WARNING - The databricks engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2335)
2025-12-02 18:44:58,186 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-02 18:44:58,410 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:44:58,410 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:44:58,410 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0cfaf-0100-1b99-9c10-eb33f3204ebd (session.py:143)
2025-12-02 18:44:58,996 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:44:58,996 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:44:59,177 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:44:59,177 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:44:59,391 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:44:59,391 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:44:59,537 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:44:59,537 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:00,255 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:00,255 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:01,340 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:01,340 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:01,811 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:01,811 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:06,876 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:06,876 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:07,134 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:07,134 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:07,866 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:07,866 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:08,094 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:08,094 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:17,391 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:17,391 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:17,642 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:17,642 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:17,677 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-12-02 18:45:17,677 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.sqlmesh__silver' (evaluator.py:1449)
2025-12-02 18:45:17,689 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`sqlmesh__silver` (base.py:2619)
2025-12-02 18:45:17,711 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-02 18:45:17,964 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:17,980 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:17,980 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0cfaf-0caa-1768-b017-bf229addc8ed (session.py:143)
2025-12-02 18:45:18,233 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:18,233 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:18,239 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.sqlmesh__gold' (evaluator.py:1449)
2025-12-02 18:45:18,241 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`sqlmesh__gold` (base.py:2619)
2025-12-02 18:45:18,424 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:18,424 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:18,436 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:123)
2025-12-02 18:45:18,436 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.sqlmesh__gold (evaluator.py:1616)
2025-12-02 18:45:18,452 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'sqlmesh__gold') AND `table_name` IN ('gold__accounts_2__2894313673', 'gold__customers_2__2439568028', 'gold__transactions_2__2629782491') (base.py:2619)
2025-12-02 18:45:18,918 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:18,918 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:18,932 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.sqlmesh__silver (evaluator.py:1616)
2025-12-02 18:45:18,934 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'sqlmesh__silver') AND `table_name` IN ('silver__transactions_2__615368167', 'silver__customers_2__562887494', 'silver__accounts_2__3741260822') (base.py:2619)
2025-12-02 18:45:19,245 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:19,245 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:19,259 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-12-02 18:45:19,259 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-12-02 18:45:19,259 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:167)
2025-12-02 18:45:19,640 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:19,640 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:19,841 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:19,841 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:20,743 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:20,744 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:21,572 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:21,572 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:23,384 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:23,384 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:24,136 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:24,136 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:24,136 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:123)
2025-12-02 18:45:26,184 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:26,186 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:28,315 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:28,315 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:30,359 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:30,359 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:30,363 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-12-02 18:45:30,363 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.gold' (evaluator.py:1449)
2025-12-02 18:45:30,363 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`gold` (base.py:2619)
2025-12-02 18:45:30,769 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:30,769 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:30,769 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.gold (evaluator.py:1616)
2025-12-02 18:45:30,769 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'gold') AND `table_name` IN ('accounts_2', 'customers_2', 'transactions_2') (base.py:2619)
2025-12-02 18:45:31,069 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:31,069 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:31,081 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-02 18:45:31,237 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:31,237 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:31,249 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.gold.accounts_2' to point at table 'newbankingdemo.sqlmesh__gold.gold__accounts_2__2894313673' (evaluator.py:1988)
2025-12-02 18:45:31,252 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ CREATE OR REPLACE VIEW `newbankingdemo`.`gold`.`accounts_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__gold`.`gold__accounts_2__2894313673` (base.py:2619)
2025-12-02 18:45:31,630 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:31,630 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:31,654 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-02 18:45:31,820 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:31,820 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:31,820 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.gold.customers_2' to point at table 'newbankingdemo.sqlmesh__gold.gold__customers_2__2439568028' (evaluator.py:1988)
2025-12-02 18:45:31,820 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ CREATE OR REPLACE VIEW `newbankingdemo`.`gold`.`customers_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__gold`.`gold__customers_2__2439568028` (base.py:2619)
2025-12-02 18:45:32,232 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:32,234 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:32,248 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-02 18:45:32,400 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:32,400 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:32,400 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.gold.transactions_2' to point at table 'newbankingdemo.sqlmesh__gold.gold__transactions_2__2629782491' (evaluator.py:1988)
2025-12-02 18:45:32,400 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4a62782fa6414ff6b4bf5f7f9202bc79 */ CREATE OR REPLACE VIEW `newbankingdemo`.`gold`.`transactions_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__2629782491` (base.py:2619)
2025-12-02 18:45:32,919 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:32,919 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:32,938 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-12-02 18:45:32,938 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-12-02 18:45:33,368 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:33,368 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:35,060 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:35,060 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:35,072 - MainThread - databricks.sql.session - INFO - Closing session 01f0cfaf-0caa-1768-b017-bf229addc8ed (session.py:194)
2025-12-02 18:45:35,139 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:35,139 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:35,139 - MainThread - databricks.sql.session - INFO - Closing session 01f0cfaf-0100-1b99-9c10-eb33f3204ebd (session.py:194)
2025-12-02 18:45:35,218 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-02 18:45:35,218 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-02 18:45:35,226 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
