2025-12-04 07:54:34,983 - MainThread - sqlmesh.core.console - WARNING - The databricks engine is not recommended for storing SQLMesh state in production deployments. Please see https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information. (console.py:2335)
2025-12-04 07:54:35,228 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-04 07:54:35,423 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:35,425 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:35,425 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0d0e6-7ac7-12b2-9b32-6c3b93a678ca (session.py:143)
2025-12-04 07:54:35,727 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:35,727 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:35,859 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:35,859 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:36,062 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:36,062 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:36,199 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:36,199 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:36,710 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:36,710 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:37,499 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:37,499 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:37,958 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:37,958 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:38,570 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:38,570 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:39,312 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:39,312 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:40,176 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:40,176 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:40,330 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:40,330 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:41,112 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:41,112 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:41,377 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:41,377 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:50,604 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:50,604 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:50,778 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:50,778 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:50,797 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-12-04 07:54:50,807 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.sqlmesh__gold' (evaluator.py:1449)
2025-12-04 07:54:50,807 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`sqlmesh__gold` (base.py:2619)
2025-12-04 07:54:50,825 - MainThread - databricks.sql.session - WARNING - [WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' instead. This parameter will be removed in the upcoming releases. (session.py:55)
2025-12-04 07:54:51,138 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:51,138 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:51,139 - MainThread - databricks.sql.session - INFO - Successfully opened session 01f0d0e6-8424-134b-b7c1-f1128d22cbe6 (session.py:143)
2025-12-04 07:54:51,358 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:51,358 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:51,372 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.sqlmesh__silver' (evaluator.py:1449)
2025-12-04 07:54:51,374 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`sqlmesh__silver` (base.py:2619)
2025-12-04 07:54:51,548 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:51,548 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:51,548 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:123)
2025-12-04 07:54:51,555 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.sqlmesh__gold (evaluator.py:1616)
2025-12-04 07:54:51,555 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'sqlmesh__gold') AND `table_name` IN ('gold__accounts_2__2894313673', 'gold__customers_2__2439568028', 'gold__transactions_2__553716356') (base.py:2619)
2025-12-04 07:54:51,890 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:51,890 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:51,890 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.sqlmesh__silver (evaluator.py:1616)
2025-12-04 07:54:51,896 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'sqlmesh__silver') AND `table_name` IN ('silver__accounts_2__3741260822', 'silver__customers_2__562887494', 'silver__transactions_2__3316432348') (base.py:2619)
2025-12-04 07:54:52,161 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:52,161 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:52,171 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-12-04 07:54:52,171 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-12-04 07:54:52,171 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:167)
2025-12-04 07:54:52,517 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:52,517 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:52,717 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:52,717 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:54,751 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:54,751 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:55,553 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:55,553 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:57,130 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:57,130 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:58,020 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:58,020 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:54:58,024 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:123)
2025-12-04 07:54:59,978 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:54:59,978 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:02,131 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:02,131 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:03,550 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:03,550 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:03,550 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-12-04 07:55:03,564 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.silver' (evaluator.py:1449)
2025-12-04 07:55:03,564 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`silver` (base.py:2619)
2025-12-04 07:55:03,887 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:03,887 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:03,893 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'newbankingdemo.gold' (evaluator.py:1449)
2025-12-04 07:55:03,894 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ CREATE SCHEMA IF NOT EXISTS `newbankingdemo`.`gold` (base.py:2619)
2025-12-04 07:55:04,128 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:04,128 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:04,144 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.gold (evaluator.py:1616)
2025-12-04 07:55:04,154 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'gold') AND `table_name` IN ('transactions_2') (base.py:2619)
2025-12-04 07:55:04,447 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:04,447 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:04,465 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema newbankingdemo.silver (evaluator.py:1616)
2025-12-04 07:55:04,465 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ SELECT `table_name` AS `name`, `table_schema` AS `schema`, `table_catalog` AS `catalog`, CASE `table_type` WHEN 'VIEW' THEN 'view' WHEN 'MATERIALIZED_VIEW' THEN 'materialized_view' ELSE 'table' END AS `type` FROM `system`.`information_schema`.`tables` WHERE (`table_catalog` = 'newbankingdemo' AND `table_schema` = 'silver') AND `table_name` IN ('transactions_2') (base.py:2619)
2025-12-04 07:55:04,777 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:04,777 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:04,791 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:55:04,952 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:04,954 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:04,959 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.silver.transactions_2' to point at table 'newbankingdemo.sqlmesh__silver.silver__transactions_2__3316432348' (evaluator.py:1988)
2025-12-04 07:55:04,963 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ CREATE OR REPLACE VIEW `newbankingdemo`.`silver`.`transactions_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__silver`.`silver__transactions_2__3316432348` (base.py:2619)
2025-12-04 07:55:05,552 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:05,554 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:05,564 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ USE CATALOG `newbankingdemo` (base.py:2619)
2025-12-04 07:55:05,745 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:05,745 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:05,745 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'newbankingdemo.gold.transactions_2' to point at table 'newbankingdemo.sqlmesh__gold.gold__transactions_2__553716356' (evaluator.py:1988)
2025-12-04 07:55:05,761 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: b017bda34a2141c6a05f6da64fa2638b */ CREATE OR REPLACE VIEW `newbankingdemo`.`gold`.`transactions_2` AS SELECT * FROM `newbankingdemo`.`sqlmesh__gold`.`gold__transactions_2__553716356` (base.py:2619)
2025-12-04 07:55:06,312 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:06,312 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:06,346 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-12-04 07:55:06,347 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-12-04 07:55:06,831 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:06,831 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:08,442 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:08,442 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:08,456 - MainThread - databricks.sql.session - INFO - Closing session 01f0d0e6-8424-134b-b7c1-f1128d22cbe6 (session.py:194)
2025-12-04 07:55:08,524 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:08,524 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:08,524 - MainThread - databricks.sql.session - INFO - Closing session 01f0d0e6-7ac7-12b2-9b32-6c3b93a678ca (session.py:194)
2025-12-04 07:55:08,588 - MainThread - databricks.sql.auth.retry - INFO - Received status code 200 for POST request (retry.py:355)
2025-12-04 07:55:08,588 - MainThread - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK (thrift_http_client.py:208)
2025-12-04 07:55:08,606 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
