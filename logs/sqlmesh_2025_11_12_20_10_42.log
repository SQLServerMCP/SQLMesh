2025-11-12 20:10:42,871 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:492)
2025-11-12 20:10:44,111 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:494)
2025-11-12 20:10:44,194 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:482)
2025-11-12 20:10:53,117 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:123)
2025-11-12 20:10:53,192 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-11-12 20:10:53,198 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1449)
2025-11-12 20:10:53,198 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2619)
2025-11-12 20:10:53,200 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:123)
2025-11-12 20:10:53,202 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:1616)
2025-11-12 20:10:53,202 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-12 20:10:53,202 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-12 20:10:53,212 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__full_model__635791289', 'sqlmesh_example__seed_model__2437004170', 'sqlmesh_example__seed_balances_model__1581770611', 'sqlmesh_example__full_model_balance__2356143081', 'sqlmesh_example__incremental_model__3572673861', 'sqlmesh_example__incremental_model_balance__1165446840') (base.py:2619)
2025-11-12 20:10:53,240 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-11-12 20:10:53,244 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-11-12 20:10:53,244 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'dev' (facade.py:167)
2025-11-12 20:10:53,269 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-11-12 20:10:53,277 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example__dev' (evaluator.py:1449)
2025-11-12 20:10:53,279 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example__dev" (base.py:2619)
2025-11-12 20:10:53,280 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh_example__dev (evaluator.py:1616)
2025-11-12 20:10:53,280 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-12 20:10:53,280 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-11-12 20:10:53,280 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh_example__dev') AND table_name IN ('seed_balances_model', 'full_model_balance', 'incremental_model', 'incremental_model_balance', 'seed_model', 'full_model') (base.py:2619)
2025-11-12 20:10:53,280 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.seed_balances_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_balances_model__1581770611' (evaluator.py:1988)
2025-11-12 20:10:53,292 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."seed_balances_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_balances_model__1581770611" (base.py:2619)
2025-11-12 20:10:53,296 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.seed_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__2437004170' (evaluator.py:1988)
2025-11-12 20:10:53,299 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."seed_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" (base.py:2619)
2025-11-12 20:10:53,302 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.incremental_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3572673861' (evaluator.py:1988)
2025-11-12 20:10:53,302 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."incremental_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" (base.py:2619)
2025-11-12 20:10:53,302 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.incremental_model_balance' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model_balance__1165446840' (evaluator.py:1988)
2025-11-12 20:10:53,302 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."incremental_model_balance" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model_balance__1165446840" (base.py:2619)
2025-11-12 20:10:53,314 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.full_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__635791289' (evaluator.py:1988)
2025-11-12 20:10:53,316 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."full_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" (base.py:2619)
2025-11-12 20:10:53,320 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.full_model_balance' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model_balance__2356143081' (evaluator.py:1988)
2025-11-12 20:10:53,320 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 97196b1cf31645de96703fd690bd221e */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."full_model_balance" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model_balance__2356143081" (base.py:2619)
2025-11-12 20:10:53,327 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-11-12 20:10:53,327 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'dev' (environment.py:141)
2025-11-12 20:10:53,371 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
